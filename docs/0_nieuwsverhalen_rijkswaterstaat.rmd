---
title: "Nieuwsverhaal Rijkswaterstaat"
author: ""
date: "April 2022"
output: github_document
header-includes: \usepackage{svdj}
editor_options:
  chunk_output_type: console
subparagraph: yes
---

```{r, echo=F, warning=F, message=FALSE}
library(writexl)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE)
library(printr)
library(amcatr)
library(tidyverse)
library(scales)
library(lubridate)
library(quanteda)
library(corpustools)
library(extrafont)
library(quanteda.textplots)
library(quanteda.textstats)
library(Cairo)
library(memoise)
library(ggplot2)
library(dplyr)
library(patchwork) # To display 2 charts together
library(hrbrthemes)
#font_import("/home/nel/Downloads/", pattern=".ttf")
#extrafont::fonts()
#extrafont::fonttable() %>% View
```

```{r, echo=F, warning=F, message=FALSE}
source("theme.R")
source("functions.R")
nieuws = readRDS("data/nieuws.rds")
totaal_rijks = readRDS("data/totaal_rijks.rds")
getmeta = memoise(nieuws, cache = cache_filesystem("tmp"))
gethits =memoise(totaal_rijks, cache = cache_filesystem("tmp"))
```

# 1. Introductie
In deze  analyse laten we de aandacht zien voor het nieuwsverhaal rond Rijkswaterstaat, wanneer de containers van het vrachtschip MSC Zoe terecht komen in de Waddenzee. Dit gebeurt begin 2019 en duurt nog weken erna omdat de berging van de containers moeizaam verloopt en er ook veel spullen aanspoelen.

# 2. Dynamiek nieuwsverhalen
In onderstaande figuur geven we weer op welke wijze de berichtgeving is verlopen. We zien rond de 0 op de x-as de dag waarop het meeste nieuws is verschenen over dit nieuwsverhaal. 

```{r, echo=F, warning=F, message=FALSE}

coa = readRDS("data/dynamiek_nieuwsverhalen.rds")%>%
  filter(verhaalid=="rijkswaterstaat_11", abs(dag_from_peak)<29)

ggplot(coa,aes(x=dag_from_peak, y=n))+
  geom_line(size=1.1, color= svdj_colors[1]) + 
  scale_linetype_manual(values=c(1,1,3)) + 
  ggtitle("Aantal nieuwsberichten rondom de piek") + 
  ylab("Aantal artikelen")+
  xlab("")+
  ylim(0,20)+
  theme_line()


```

Hier is duidelijk te zien dat dit een nieuwsverhaal is dat eigenlijk begint bij de piek in aandacht. Er is slechts een kleine aanloop naar de piek in het nieuws en daarna komt het verhaal steeds terug doordat er ontwikkelingen te melden zijn. 
\newpage

# 3. Aantallen berichten per mediumtype
In onderstaande figuur zien we de aandacht voor het nieuwsverhaal in de verschillende mediagroepen.

```{r, echo=F, warning=F, message=FALSE}
alleverhalen=readRDS("data/alleverhalen.rds")
alleverhalen%>%
  filter(verhaalid=="rijkswaterstaat_11")|>
  group_by(medtype) |>
  summarize(n=n()) |>
  mutate(perc=n/sum(n)*100) |>
  ggplot(aes(x="", y=perc, fill=medtype))+
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)+
  geom_text(aes(label = paste0(round(perc,0),"%")),
            position = position_stack(vjust = 0.5), color="white", size=4)+
  theme_pie()+   scale_fill_manual(values = svdj_colors)



```

We zien dat het meeste nieuws te vinden is op de online nieuwssites (59%) gevolgd door de dagbladen (30%). De Televisieprogramma's nemen een klein deel van de berichtgeving voor hun rekening (8%) en de Kamervragen vertegenwoordigen 3% van het nieuws.

\newpage

# 4. Aandacht per mediumtype per week
In onderstaande figuur geven we weer hoe de verichtgeving verloopt per week.
In het midden (bij de 0 op de x-as) is de week waarin de meeste berichgeving te vinden is over het nieuwsverhaal rond containers die in zee zijn gevallen.

```{r, echo=F, warning=F, message=FALSE}

piekdagen=readRDS("data/piek_per_verhaal.rds")
verhalen = readRDS("data/alleverhalen.rds")%>%rename(nverhaal=n)


verhalen %>%
  filter(verhaalid=="rijkswaterstaat_11")|>
  left_join(piekdagen) |>
  group_by(medtype, dag_from_peak)|>
  summarize(n=n()) |>
  mutate(perc=n/sum(n)*100) |>
  add_zeroes(index_cols=c("medtype", "dag_from_peak"))|>
  mutate(week=round(dag_from_peak/7)) |> 
  filter(abs(week) <= 5) |>  
  group_by(week, medtype) |>
  summarize(n=sum(n))|>
  mutate(perc=n/sum(n)*100) |>
  ggplot(aes(x=week, y=n,  color=medtype)) + 
  ylab("Aantal artikelen") + 
  xlab("")+
  geom_line()+ theme_line()+
  scale_x_continuous(breaks=c(-5,-4,-3,-2,-1,0,1,2,3,4,5))+
  scale_color_manual(values = svdj_colors) 


```

We zien dat het nieuws vooral wordt gedomineerd door berichtgeving op de online sites en dit blijft de gehele periode het geval. Er is in de dagbladen een aantal weken aandacht voor het verhaal waarna er steeds minder aandacht voor is. Ook op Televisie, met name in het nieuws, is er steeds aandacht voor het verhaal en in de Kamer worden op verschillende momenten vragen gesteld. 

\newpage


# 5. Aantal artikelen en lengte van artikelen per week rond piek
In onderstaande figuur geven we twee lijnen weer. Allereerst de mint groene lijnen die het aantal artikelen weergeeft per week. De oranje lijn geeft het gemiddelde aantal woorden weer dat een artikel in die week bevatte. Hierbij hebben we de televisie-uitzendingen achterwege gelaten. 


```{r, echo=F, warning=F, message=FALSE}
descriptives=readRDS("data/descriptives.rds")

d5=descriptives|>
  filter(verhaalid=="coa_5")|>
  mutate(week=round(dag_from_peak/7)) |> 
  filter(abs(week) <= 4) |>
  group_by(week) |>
  summarize(nwords=sum(nwords),
            nsentences=sum(nsentences),
            n=sum(n))|>
  mutate(meanwords=nwords/n,
         meansentences=nsentences/n)

coeff = 10

ggplot(d5, aes(x=week))+
  geom_line(aes(y=n), color = kleur1 )+
  geom_line(aes(y=meanwords/coeff), color=kleur2)+
  scale_y_continuous(name = "Aantal artikelen",
                     sec.axis = sec_axis(~.*coeff, name="Gemiddeld aantal woorden"))+
  theme_line_secondary() +
  xlab("")+
  scale_x_continuous(breaks=c(-5,-4,-3,-2,-1,0,1,2,3,4,5))

```

We zien dat tijdens de piek van de aandacht de artikelen minder lang zijn geworden. Er wordt door veel media geschreven over de containers, maar dat zijn vooral korte berichten. Naarmate de tijd vordert komen er minder artikelen in het nieuws, maar die zijn wel aanzienlijk langer. Het gaat dan vooral om terugblikken en analyses. 

# 6. Wordcloud
In onderstaande figuur geven we een wordcloud weer van de woorden die het meest voorkomen in het nieuws over dit nieuwsverhaal.

```{r, echo=F, warning=F, message=FALSE}
dfm=readRDS("data/dfm_alleverhalen.rds")

textstat_keyness(dfm, docvars(dfm)$verhaalid=="rijkswaterstaat_11") |> 
  arrange(-chi2) |> 
  head(100) |>
  with(wordcloud::wordcloud(feature, chi2, random.order = F,scale = c(2, .2), colors = "#80cdbe"))

```

We zien dat het woord containers prominent voorkomt in al het nieuws. Net als de woorden overboord en de naam van de boot Zoe. Ook de Waddenzee komt regelmatig terug in het nieuws. 

# 7. Bronnen in het nieuws
In deze analyse gaan we in op de bronnen van het nieuws en kijken in hoeverre deze voorkomen in het nieuws.
We hebben hiervoor de computer laten traceren wie er als bron in het nieuws naar voren komt. Deze bronnen hebben wij ingedeeld in de volgende categorieen. 

Rijksuitvoeringsorganisaties, Politiek, Ministerie, Expert, Media, Belangenorganisatie, Burgers, B&W en Bedrijsleven.

In onderstaande figuur geven we weer in hoeverre deze groepen bronnen naar voren komen in de berichtgeving. 

```{r, echo=F, warning=F, message=FALSE}
bronnen_per_verhaal = readRDS("data/bronnen_per_verhaal2.rds")


bronnen_per_verhaal %>%
  filter(verhaalid=="rijkswaterstaat_11", ! is.na(group))|> 
  filter(medtype != "Televisie")|>
  group_by( group) |>
  summarize(source=sum(source),other=sum(other)) |>
  mutate(perc = round(source/sum(source)*100,1), gezag =source/(source+other)*100) |>
  ggplot(aes(x="", y=perc, fill=group))+
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)+
  geom_text(aes(label = round(perc,0)), 
            position = position_stack(vjust = 0.5), color="white", size=3)+
  theme_pie()  + scale_fill_manual(values = svdj_colors) 


```

We zien dat de Rijksuitvoeringsorganisatie, in dit geval Rijkswaterstaat, het vaakst aan het woord wordt gelaten in de berichtgeving. Daarnaast hebben de media veel ruimte voor experts als bron van het nieuws en worden ook belangenorganisaties veelvuldig aan het woord gelaten. Het ministerie en de politici komen in beperkte mate aan het woord. 

\newpage

# 8. Bronnen in het nieuws per type media
In onderstaande figuur geven we weer in hoeverre de verschillende bronnen naar voren kwamen in het nieuws van de dagbladen, de online nieuwssites en in de Kamervragen.

```{r, echo=F, warning=F, message=FALSE}

bronnen_per_verhaal %>%
   mutate(soortpiek=case_when(verhaal %in% c("belastingdienst", "cbr","coa","uwv","nvwa","venj","rvo","ind","rivm","dji","arbeidsinspectie") ~"Ondergravend",
                          verhaal %in% c("acm","igj","ilt","kadaster","kvk","nfi", "knmi","onderwijsinspectie") ~ "Constructief",
                          verhaal %in% c("rijkswaterstaat","marechaussee","svb","sbb","politie","om")~"Constructief"))|>
  filter(verhaalid=="rijkswaterstaat_11", ! is.na(group))|> 
  filter(medtype != "Televisie")|>
  group_by(soortpiek,medtype, group) |>
  summarize(source=sum(source),other=sum(other)) |>
  mutate(perc = round(source/sum(source)*100,1), gezag =source/(source+other)*100) |>
  ggplot(aes(x="", y=perc, fill=group))+
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)+
  facet_grid(~medtype)+
  geom_text(aes(label = round(perc,0)), 
            position = position_stack(vjust = 0.5), color="white", size=3)+
  theme_pie()  + scale_fill_manual(values = svdj_colors) 
```

We zien dat de Rijksuitvoeringsorganisatie iets vaker in het nieuws als bron naar voren kwam in dagbladen dan in de artikelen op de nieuwssites en in de Kamervragen. Experts en belangenorganisaties komen nagenoeg even vaak als bron van het nieuws terug in dagbladen en op de nieuwssites. Online nieuwssites citeren wel vaker andere media. 

# 9. Bronnen in het nieuws over tijd
In onderstaande figuur geven we weer in hoeverre de verschillende bronnen voorkomen in het nieuwsverhaal rond Rijkswaterstaat in aanloop naar de week met het meeste nieuws en in de weken erna.

```{r, echo=F, warning=F, message=FALSE}


piekdagen=readRDS("data/piek_per_verhaal.rds")

bronnen = readRDS("data/bronnen_per_verhaal2.rds")
alleverhalen = readRDS("data/alleverhalen.rds")


bronnen |> filter(! is.na(group))|>
  filter(id %in% alleverhalen$id, medtype != "Televisie")|>
  group_by(verhaalid,date,id, group)%>%
  summarize(nbron=sum(source), .groups="drop")%>%
  group_by(verhaalid, date, group) |>
  summarize(nb=sum(nbron), .groups="drop") |> 
  filter(verhaalid=="coa_5") |>
  left_join(piekdagen) |>
  select(dag_from_peak, nb, group) |>
  add_zeroes(index_cols=c("dag_from_peak", "group"))|>
  mutate(week=round(dag_from_peak/7)) |> 
  filter(abs(week) <= 4) |>
  group_by(week, group) |>
  summarize(nb=sum(nb)) |> 
  mutate(perc=nb/sum(nb)*100)|>
  ggplot(aes(x=week, y=nb, color=group)) + geom_line()+
    ylab("")+
  xlab("")+
  theme_line() +scale_color_manual(values = svdj_colors)  +
  scale_x_continuous(breaks=c(-5,-4,-3,-2,-1,0,1,2,3,4,5))
```

We zien dat in het begin van dit nieuwsverhaal het vooral Rijkswaterstaat is dat in het nieuws verschijnt als bron. Daarna komt het ministerie meer aan het woord en ik ser ook ruimte voor politici en experts. Tijdens de piek in de aandacht wordt vooral het ministerie aan het worod gelaten en erna is het weer vooral Rijkswaterstaat. 


\newpage

# 10. Frames
Het verhaal rond Rijkswaterstaat vooral constructief een meerderheid van de frames valt in die categorie, zoals ook blijkt uit onderstaande figuur. 

```{r, echo=F, warning=F, message=FALSE}


framing = read_csv("data/framing.csv")%>%
  filter(verhalen =="rijkswaterstaat_11")|>
  mutate(aantal = as.numeric(aantal))%>%
  mutate(soortframe = case_when(frame %in% c("mensen","kritisch","vakman","plicht") ~ "Constructief",
                                frame %in% c("schoot","soft","grip","kapot","maat","toren","vlinder")~ "Ondergravend",
                                T ~ "Neutraal"))|>
  group_by(frame)%>%
  summarize(n=sum(aantal))%>%
  mutate(perc=n/sum(n)*100)



ggplot(framing, aes(x="", y=perc, fill=frame))+
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)+
  geom_text(aes(label = round(perc,0)), 
            position = position_stack(vjust = 0.5), color="white", size=3)+
  theme_pie() + scale_fill_manual(values = svdj_colors) 


```

Veruit het meest gebruikte frame is het Plichtsbesef frame. Oftewel Rijkswaterstaat doet waarvoor het op aarde is. Daarnaast wordt het frame dat Rijkswaterstaat beschrijft als kritische tegenlezer regelmatig gebruikt. In dit geval betekent dit dat Rijkswaterstaat waarschuwt voor de problemen die zijn ontstaan door de containers en wat we hier in de toekomst tegen kunnen doen. 

\newpage

# 11. Frames in de verschillende type media
In onderstaande figuur geven we het gebruik van de frames weer in de verschillende soorten media.

```{r, echo=F, warning=F, message=FALSE}
framing = read_csv("data/framing.csv")%>%rename(verhaalid=verhalen)
nieuws=readRDS("data/nieuws.rds")
alleverhalen = readRDS("data/alleverhalen.rds")
piekdagen=readRDS("data/piek_per_verhaal.rds")

framing |>
  left_join(nieuws)|>
  filter(id %in% alleverhalen$id)|>
  mutate(frametoon=case_when(soortframe=="Ondergravend" ~ -1,
                             soortframe=="Constructief" ~ 1,
                              T~0)) |>
  group_by(verhaalid,date, id) |>
  summarize(nframes=sum(aantal), frametoon=sum(frametoon * aantal))|>
  mutate(ifframe=case_when(nframes==0 ~ "Ongeframed",
                         frametoon==0 ~ "Neutraal/gemengd",
                         frametoon <0 ~ "Ondergravend",
                         frametoon>0  ~ "Constructief")) |>
  filter(verhaalid=="rijkswaterstaat_11")|>
  group_by(verhaalid, ifframe) |>
  summarize(nf=n(), .groups="drop") |>
  mutate(perc=nf/sum(nf)*100)|>
  ggplot( aes(x="", y=perc, fill=ifframe))+
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)+
  geom_text(aes(label = round(perc,0)), 
            position = position_stack(vjust = 0.5), color="white", size=3)+
  theme_pie() + scale_fill_manual(values = svdj_colors) 

```

In de Kamervragen wordt slechts het Kritisch tegenlezer frame gebruikt. In de overige media is het plichtsframe dominant. Het sterkst in de berichtgeving online. De kritische tegenlezer is op televisie aanzienlijk minder gebruikt dan in de andere media, terwijl in de dagbladen het vlinder effect frame ook terug te vinden is. Hierbij gaat het erom dat er door een kleine fout een keten van fouten in werking gezet kan worden die kunnen leiden tot een ramp. 

# 12. Soorten frames in de verschillende type media
In onderstaande figuur geven we het gebruik van de frames weer in de verschillende soorten media. Hierbij hebben we ook gekeken naar de berichten waarin niet wordt geframed, oftewel de feitelijke berichtgeving.

```{r, echo=F, warning=F, message=FALSE}
framing = read_csv("data/framing.csv")%>%rename(verhaalid=verhalen)
nieuws=readRDS("data/nieuws.rds")
alleverhalen = readRDS("data/alleverhalen.rds")
piekdagen=readRDS("data/piek_per_verhaal.rds")

framing |>
  left_join(alleverhalen)|>
  filter(id %in% alleverhalen$id)|>
  mutate(frametoon=case_when(soortframe=="Ondergravend" ~ -1,
                             soortframe=="Constructief" ~ 1,
                              T~0)) |>
  group_by(verhaalid,medtype,id) |>
  summarize(nframes=sum(aantal), frametoon=sum(frametoon * aantal))|>
  mutate(ifframe=case_when(nframes==0 ~ "Ongeframed",
                         frametoon==0 ~ "Neutraal/gemengd",
                         frametoon <0 ~ "Ondergravend",
                         frametoon>0  ~ "Constructief")) |>
  filter(verhaalid=="rijkswaterstaat_11")|>
  group_by(medtype, ifframe)|>
  summarize(nf=n()) |>
  mutate(perc=nf/sum(nf)*100)|>
  ggplot( aes(x="", y=perc, fill=ifframe))+
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)+
  facet_grid(~ medtype)+
  geom_text(aes(label = round(perc,0)), 
            position = position_stack(vjust = 0.5), color="white", size=3)+
  theme_pie() + scale_fill_manual(values = svdj_colors) 

```  

We zien dat in de Kamervragen er vooral ongeframede berichtgeving voorkomt en in 17% slechts sprake is van een constructief frame.

Op televisie vinden we de meeste berichtgeving waarin neutraal of gemengd wordt geframed. Ongeframed berichtgeving vinden we daar niet. 

Onlie zien we iets meer ongeframede berichtgeving dan in de dagbladen, terwijl in de dagbladen meer berichtgeving te vinden is die neutraal is geframed of ondergravend. 

# 13. Frames over tijd
In onderstaande figuur geven we weer in hoeverre er constructieve en ondergravende frames voorkwamen in het nieuws en in hoeverre het nieuws neutraal was of zowel constructieve als ondergravende frames bevatte. Daarnaast onderscheiden we nog een vierde categorie berichten, namelijk die berichten waarin geen frame te vinden was. Dit zijn berichten waarin vooral feiten worden weergegeven die verder niet in een bepaalde context worden geplaatst. 

```{r, echo=F, warning=F, message=FALSE}
framing = read_csv("data/framing.csv")%>%rename(verhaalid=verhalen)
nieuws=readRDS("data/nieuws.rds")
alleverhalen = readRDS("data/alleverhalen.rds")
piekdagen=readRDS("data/piek_per_verhaal.rds")

framing |>
  left_join(nieuws)|>
  filter(id %in% alleverhalen$id)|>
  mutate(frametoon=case_when(soortframe=="Ondergravend" ~ -1,
                             soortframe=="Constructief" ~ 1,
                              T~0)) |>
  group_by(verhaalid,date, id) |>
  summarize(nframes=sum(aantal), frametoon=sum(frametoon * aantal))|>
  mutate(ifframe=case_when(nframes==0 ~ "Ongeframed",
                         frametoon==0 ~ "Neutraal/gemengd",
                         frametoon <0 ~ "Ondergravend",
                         frametoon>0  ~ "Constructief")) |>
  group_by(verhaalid, date, ifframe) |>
  summarize(nf=n(), .groups="drop") |> 
  filter(verhaalid=="rijkswaterstaat_11") |>
  left_join(piekdagen) |>
  select(dag_from_peak, nf, ifframe) |>
  mutate(dag_from_peak = as.integer(dag_from_peak)) |>
  add_zeroes(index_cols=c("dag_from_peak", "ifframe"))|>
  mutate(week=round(dag_from_peak/7)) |> 
  filter(abs(week) <= 5) |>
  group_by(week, ifframe) |>
  summarize(nf=sum(nf))|>
  ggplot(aes(x=week, y=nf,  color=ifframe)) + geom_line()+
  ylab("Aantal artikelen")+
  xlab("")+
  theme_line() +scale_color_manual(values = svdj_colors)  +
  scale_x_continuous(breaks=c(-5,-4,-3,-2,-1,0,1,2,3,4,5))

```

We zien dat het patroon eenzijdig is, het constructieve frame domineert de gehele periode.
Heel af en toe zijn er artikelen te zien die niet geframed zijn of waar ook een ondergravend frame wordt genoemd, maar die zijn zeldzaam.
\newpage
