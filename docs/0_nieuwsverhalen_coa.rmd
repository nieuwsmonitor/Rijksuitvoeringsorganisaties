---
title: "Nieuwsverhaal COA"
author: ""
date: "April 2022"
output: github_document
header-includes: \usepackage{svdj}
editor_options:
  chunk_output_type: console
subparagraph: yes
---

```{r, echo=F, warning=F, message=FALSE}
library(writexl)
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = FALSE)
library(printr)
library(amcatr)
library(tidyverse)
library(scales)
library(lubridate)
library(quanteda)
library(corpustools)
library(extrafont)
library(quanteda.textplots)
library(quanteda.textstats)
library(Cairo)
library(memoise)
library(ggplot2)
library(dplyr)
library(patchwork) # To display 2 charts together
library(hrbrthemes)
#font_import("/home/nel/Downloads/", pattern=".ttf")
#extrafont::fonts()
#extrafont::fonttable() %>% View
```

```{r, echo=F, warning=F, message=FALSE}
source("theme.R")
source("functions.R")
nieuws = readRDS("data/nieuws.rds")
totaal_rijks = readRDS("data/totaal_rijks.rds")
getmeta = memoise(nieuws, cache = cache_filesystem("tmp"))
gethits =memoise(totaal_rijks, cache = cache_filesystem("tmp"))
```

# 1. Inleiding
In deze analyse laten we zien in hoeverre het nieuwsverhaal rond het COA eind 2021 in het nieuws is geweest. Het gaat hierbij om de opvang van asielzoekers uit Afghanistan die na de inname van het land door de Taliban zijn gevlucht. 

# 2. Dynamiek nieuwsverhalen
In onderstaande figuur gewen we weer in hoeverre de berichtgeving is verlopen. We zien rond de 0 op de x-as de dag waarop het meeste nieuws is verschenen over dit nieuwsverhaal. 

```{r, echo=F, warning=F, message=FALSE}

coa = readRDS("data/dynamiek_nieuwsverhalen.rds")%>%
  filter(verhaal=="coa", abs(dag_from_peak)<29)

ggplot(coa,aes(x=dag_from_peak, y=n))+
  geom_line(size=1.1, color= svdj_colors[1]) + 
  scale_linetype_manual(values=c(1,1,3)) + 
  ggtitle("Aantal nieuwsberichten rondom de piek") + 
  ylab("Aantal artikelen")+
  xlab("")+
  ylim(0,20)+
  theme_line()



```
\newpage

# 3. Aantallen berichten per mediumtype

In onderstaande figuur zien we de aandacht voor het nieuwsverhaal in de verschillende mediagroepen.

```{r, echo=F, warning=F, message=FALSE}
alleverhalen=readRDS("data/alleverhalen.rds")
alleverhalen%>%
  filter(verhaalid=="coa_5")|>
  group_by(medtype) |>
  summarize(n=n()) |>
  mutate(perc=n/sum(n)*100) |>
  ggplot(aes(x="", y=perc, fill=medtype))+
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)+
  geom_text(aes(label = paste0(round(perc,0),"%")),
            position = position_stack(vjust = 0.5), color="white", size=4)+
  theme_pie()+   scale_fill_manual(values = svdj_colors)



```

We zien dat het meeste nieuws te vinden is in de dagbladen (43%) gevolgd door de online nieuwssites (36%). De Televisieprogramma's nemen een aanzienlijk deel van de berichtgeving voor hun rekening (17%) terwijl de Kamervragen 4% van de berichtgeving vertegenwoordigen.

\newpage

# 4. Aandacht per mediumtype per week
In onderstaande figuur geven we weer hoe de verichtgeving verloopt per week.
In het midden (bij de 0 op de x-as) is de week waarin de meeste berichgeving te vinden is over het nieuwsverhaal rond de opvang van de vluchtelingen.

```{r, echo=F, warning=F, message=FALSE}

piekdagen=readRDS("data/piek_per_verhaal.rds")
verhalen = readRDS("data/alleverhalen.rds")%>%rename(nverhaal=n)


verhalen %>%
  filter(verhaalid=="coa_5")|>
  left_join(piekdagen) |>
  group_by(medtype, dag_from_peak)|>
  summarize(n=n()) |>
  mutate(perc=n/sum(n)*100) |>
  add_zeroes(index_cols=c("medtype", "dag_from_peak"))|>
  mutate(week=round(dag_from_peak/7)) |> 
  filter(abs(week) <= 5) |>  
  group_by(week, medtype) |>
  summarize(n=sum(n))|>
  mutate(perc=n/sum(n)*100) |>
  ggplot(aes(x=week, y=n,  color=medtype)) + 
  ylab("Aantal artikelen") + 
  xlab("")+
  geom_line()+ theme_line()+
  scale_x_continuous(breaks=c(-5,-4,-3,-2,-1,0,1,2,3,4,5))+
  scale_color_manual(values = svdj_colors) 


```

We zien dat het nieuws vooral wordt gedomineerd door berichtgeving in de dagbladen, maar dat in de weken voor de piek ook veel aandacht is op televisie. In een groot aantal uitzendingen, zowel nieuws als achtergronden en aan de talkshowstafels wordt er over het onderwerp gesproken. Ook valt het op dat er steeds Kamervragen worden gesteld in de eerste weken tot aan de piek. Daarna neemt het nieuws direct snel af en is er nog een kleine opleving na een paar weken. 
\newpage


# 5. Aantal artikelen en lengte van artikelen per week rond piek
In onderstaande figuur geven we twee lijnen weer. Allereerst de mint groene lijnen die het aantal artikelen weergeeft per week. De ornaje lijn geeft het gemiddelde aantal woorden weer dat een artikel in die week bevatte. Hierbij hebben we de televisie-uitzendingen achterwege gelaten. 


```{r, echo=F, warning=F, message=FALSE}
descriptives=readRDS("data/descriptives.rds")

d5=descriptives|>
  filter(verhaalid=="coa_5")|>
  mutate(week=round(dag_from_peak/7)) |> 
  filter(abs(week) <= 5) |>
  group_by(week) |>
  summarize(nwords=sum(nwords),
            nsentences=sum(nsentences),
            n=sum(n))|>
  mutate(meanwords=nwords/n,
         meansentences=nsentences/n)

coeff = 10

ggplot(d5, aes(x=week))+
  geom_line(aes(y=n), color = kleur1 )+
  geom_line(aes(y=meanwords/coeff), color=kleur2)+
  scale_y_continuous(name = "Aantal artikelen",
                     sec.axis = sec_axis(~.*coeff, name="Gemiddeld aantal woorden"))+
  theme_line_secondary() +
  xlab("")+
  scale_x_continuous(breaks=c(-5,-4,-3,-2,-1,0,1,2,3,4,5))

```

We zien dat naarmate de tijd vordert er meer artikelen per week worden geschreven, maar de gemiddelde lengte van de artikelen gaat naar beneden. Na de piek in de aandacht zie je het omgekeerde gebeuren. Er worden minder artikelen geschreven, maar de gemiddelde lengte van de artikelen neemt aanzienlijk toe. 

# 6. Wordcloud
In onderstaande figuur geven we een wordcloud weer van de woorden die het meest voorkomen in het nieuws over dit nieuwsverhaal.

```{r, echo=F, warning=F, message=FALSE}
dfm=readRDS("data/dfm_alleverhalen.rds")

textstat_keyness(dfm, docvars(dfm)$verhaalid=="coa_5") |> 
  arrange(-chi2) |> 
  head(100) |>
  with(wordcloud::wordcloud(feature, chi2, random.order = F,scale = c(2, .2), colors = "#80cdbe"))

```

We zien dat het COA hier veruit het grootste is. Daarnaast gaat het nieuws vooral over de (nood)opvang van asielzoekers, gaat het over de vraag of er genoeg opvangplekken zijn. Worden statushouders genoemd en ook gaat het over concrete plaatsten zoals Harskamp en Ter Apel, waar vluchtelingen worden opgevangen. 

# 7. Bronnen in het nieuws
In deze analyse gaan we in op de bronnen van het nieuws en kijken in hoeverre deze voorkomen in het nieuws.
We hebben hiervoor de computer laten traceren wie er als bron in het nieuws naar voren komt. Deze bronnen hebben wij ingedeeld in de volgende categorieen. 

Rijksuitvoeringsorganisaties, Politiek, Ministerie, Expert, Media, Belangenorganisatie, Burgers, B&W en Bedrijsleven.

In onderstaande figuur geven we weer in hoeverre deze groepen bronnen naar voren komen in de berichtgeving. 

```{r, echo=F, warning=F, message=FALSE}
bronnen_per_verhaal = readRDS("data/bronnen_per_verhaal2.rds")


bronnen_per_verhaal %>%
  filter(verhaal=="coa", ! is.na(group))|> 
  filter(medtype != "Televisie")|>
  group_by( group) |>
  summarize(source=sum(source),other=sum(other)) |>
  mutate(perc = round(source/sum(source)*100,1), gezag =source/(source+other)*100) |>
  ggplot(aes(x="", y=perc, fill=group))+
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)+
  geom_text(aes(label = round(perc,0)), 
            position = position_stack(vjust = 0.5), color="white", size=3)+
  theme_pie()  + scale_fill_manual(values = svdj_colors) 


```

We zien dat de Rijksuitvoeringsorganisatie, in dit geval het COA, het vaakst aan het woord wordt gelaten in de berichtgeving. Daarnaast hebben de media veel ruimte voor de politiek als bron van het nieuws en het ministerie. Ook komen burgemeesters en wethouders aan het woord, vooral wanneer het gaat om de mogelijke opvang in een specifieke gemeente. 

\newpage

# 8. Bronnen in het nieuws per type media
In onderstaande figuur geven we weer in hoeverre de verschillende bronnen naar voren kwamen in het nieuws van de dagbladen, de online nieuwssites en in de Kamervragen.

```{r, echo=F, warning=F, message=FALSE}

bronnen_per_verhaal %>%
   mutate(soortpiek=case_when(verhaal %in% c("belastingdienst", "cbr","coa","uwv","nvwa","venj","rvo","ind","rivm","dji","arbeidsinspectie") ~"Ondergravend",
                          verhaal %in% c("acm","igj","ilt","kadaster","kvk","nfi", "knmi","onderwijsinspectie") ~ "Constructief",
                          verhaal %in% c("rijkswaterstaat","marechaussee","svb","sbb","politie","om")~"Constructief"))|>
  filter(verhaal=="coa", ! is.na(group))|> 
  filter(medtype != "Televisie")|>
  group_by(soortpiek,medtype, group) |>
  summarize(source=sum(source),other=sum(other)) |>
  mutate(perc = round(source/sum(source)*100,1), gezag =source/(source+other)*100) |>
  ggplot(aes(x="", y=perc, fill=group))+
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)+
  facet_grid(~medtype)+
  geom_text(aes(label = round(perc,0)), 
            position = position_stack(vjust = 0.5), color="white", size=3)+
  theme_pie()  + scale_fill_manual(values = svdj_colors) 
```

We zien dat de Rijksuitvoeringsorganisatie veel vaker in het nieuws als bron naar voren kwam op de nieuwssites dan in de dagbladen en in de Kamervragen. Politici aan de andere kant kwamen nauwelijks voor als bron van het nieuws in de online nieuwsberichten. De dagbladen hadden meer oog voor de politici als bron van het nieuws. Dit gold ook voor de verschilldende burgemeesters en wethouders. 

# 9. Bronnen in het nieuws over tijd
In onderstaande figuur geven we weer in hoeverre de verschillende bronnen voorkomen in het nieuwsverhaal rond het COA in aanloop naar de week met het meeste nieuws en in de weken erna.

```{r, echo=F, warning=F, message=FALSE}


piekdagen=readRDS("data/piek_per_verhaal.rds")

bronnen = readRDS("data/bronnen_per_verhaal2.rds")
alleverhalen = readRDS("data/alleverhalen.rds")


bronnen |> filter(! is.na(group))|>
  filter(id %in% alleverhalen$id, medtype != "Televisie")|>
  group_by(verhaalid,date,id, group)%>%
  summarize(nbron=sum(source), .groups="drop")%>%
  group_by(verhaalid, date, group) |>
  summarize(nb=sum(nbron), .groups="drop") |> 
  filter(verhaalid=="coa_5") |>
  left_join(piekdagen) |>
  select(dag_from_peak, nb, group) |>
  add_zeroes(index_cols=c("dag_from_peak", "group"))|>
  mutate(week=round(dag_from_peak/7)) |> 
  filter(abs(week) <= 4) |>
  group_by(week, group) |>
  summarize(nb=sum(nb)) |> 
  mutate(perc=nb/sum(nb)*100)|>
  ggplot(aes(x=week, y=nb, color=group)) + geom_line()+
    ylab("")+
  xlab("")+
  theme_line() +scale_color_manual(values = svdj_colors)  +
  scale_x_continuous(breaks=c(-5,-4,-3,-2,-1,0,1,2,3,4,5))
```

We zien dat in het begin van dit nieuwsverhaal het voor het COA zelf is dat in het nieuws verschijnt als bron. Daarna komen er ook meer politici in het nieuws als bron en worden zij vaker of net zo vaak als bron opgevoerd in het nieuws als de Rijksuitvoeringsorganisatie zelf. De week waarin het meeste nieuws veschijnt zien we dat het vooral het ministerie is dat aan het woord komt in het nieuws. De weken erna verdwijnen de politici en het ministerie op de achtergrond en wordt het COA weer vaker aan het woord gelaten. 

\newpage

# 10. Frames
Het verhaal rond het COA is vooral ondergravend; een meerderheid van de frames valt in die categorie, zoals ook blijkt uit onderstaande figuur. 

```{r, echo=F, warning=F, message=FALSE}


framing = read_csv("data/framing.csv")%>%
  filter(verhaal =="coa")|>
  mutate(aantal = as.numeric(aantal))%>%
  mutate(soortframe = case_when(frame %in% c("mensen","kritisch","vakman","plicht") ~ "Constructief",
                                frame %in% c("schoot","soft","grip","kapot","maat","toren","vlinder")~ "Ondergravend",
                                T ~ "Neutraal"))|>
  group_by(frame)%>%
  summarize(n=sum(aantal))%>%
  mutate(perc=n/sum(n)*100)



ggplot(framing, aes(x="", y=perc, fill=frame))+
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)+
  geom_text(aes(label = round(perc,0)), 
            position = position_stack(vjust = 0.5), color="white", size=3)+
  theme_pie() + scale_fill_manual(values = svdj_colors) 


```

De helft van de frames (50%) bestaat uit het frame 'Geen grip'. Het COA kon de stroom vluchtelingen niet aan was de strekking van het nieuwsverhaal. Daarnaast is het frame 'gedeelde verantwoordelijkheid' groot, oftewel de problematiek is niet alleen het probleem van de RUO. In dit geval betekende het dat in de berichtgeving ook aandacht was voor de verschillende gemeenten die vluchtelingen wilden of moesten opvangen. 

Het frame 'Grenzen' gaat erover dat de Rijksuitvoeringsorganisatie nu eenmaal moet werken binnen de grenzen en mogelijkheden van de wet zoals die door hen wordt uitgevoerd. Daarmee wordt ook vaak gewezen naar Den Haag waar de beleidsmakers niet altijd oog hebben voor de uitvoering van de wet. Ook waar het gaat om het frame 'Kapot bezuinigd' wordt Den Haag veelal genoemd. In dit verhaal komt dit frame ook met regelmaat terug. Juist de bezuiningen van de afgelopen jaren hebben de situatie veroorzaakt. 

\newpage

# 11. Frames in de verschillende type media
In onderstaande figuur geven we het gebruik van de frames weer in de verschillende soorten media.

```{r, echo=F, warning=F, message=FALSE}
nieuws=readRDS("data/nieuws.rds")
framing = read_csv("data/framing.csv")|>
  rename(verhaalid=verhalen)
framing |>
  left_join(nieuws)|>
  filter(! is.na(medtype), verhaalid=="coa_5")|>
  group_by(medtype,frame)%>%
  filter(verhaal != "kadaster")|>
  summarize(n=sum(aantal))%>%
  mutate(perc=n/sum(n)*100)|>
  ggplot(aes(x="", y=perc, fill=frame))+
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)+
  facet_wrap(~ medtype) +
  geom_text(aes(label = round(perc,0)), 
            position = position_stack(vjust = 0.5), color="white", size=2.5)+
  theme_pie()+   scale_fill_manual(values = svdj_colors) 
```  

We zien dat in alle media het frame Geen Grip het vaakst voorkomt. Daarnaast is er veel aandacht voor het frame van gedeelde verantwoordelijkheid. Alleen in Kamervragen is dit frame niet terug te vinden. Daar zien we wel aandacht voor het "Kapot bezuinigd" frame en het Soft frame, oftewel de RUO opereert te soft en zou harder moeten optreden. In de overige media is dit frame niet of nauwelijks terug te vinden. Het frame waarbij het gaat om de 'grenzen en de moetjes' van de wet komen in alle media terug. Het vaakst op televisie.

# 12. Soorten frames in de verschillende type media
In onderstaande figuur geven we het gebruik van de frames weer in de verschillende soorten media. Hierbij hebben we ook gekeken naar de berichten waarin niet wordt geframed, oftewel de feitelijke berichtgeving.

```{r, echo=F, warning=F, message=FALSE}
framing = read_csv("data/framing.csv")%>%rename(verhaalid=verhalen)
nieuws=readRDS("data/nieuws.rds")
alleverhalen = readRDS("data/alleverhalen.rds")
piekdagen=readRDS("data/piek_per_verhaal.rds")

framing |>
  left_join(alleverhalen)|>
  filter(id %in% alleverhalen$id)|>
  mutate(frametoon=case_when(soortframe=="Ondergravend" ~ -1,
                             soortframe=="Constructief" ~ 1,
                              T~0)) |>
  group_by(verhaalid,medtype,id) |>
  summarize(nframes=sum(aantal), frametoon=sum(frametoon * aantal))|>
  mutate(ifframe=case_when(nframes==0 ~ "Ongeframed",
                         frametoon==0 ~ "Neutraal/gemengd",
                         frametoon <0 ~ "Ondergravend",
                         frametoon>0  ~ "Constructief")) |>
  filter(verhaalid=="coa_5")|>
  group_by(medtype, ifframe)|>
  summarize(nf=n()) |>
  mutate(perc=nf/sum(nf)*100)|>
  ggplot( aes(x="", y=perc, fill=ifframe))+
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0)+
  facet_grid(~ medtype)+
  geom_text(aes(label = round(perc,0)), 
            position = position_stack(vjust = 0.5), color="white", size=3)+
  theme_pie() + scale_fill_manual(values = svdj_colors) 
```

In de online berichtgeving komen relatief de meeste ongeframede berichten terug. In een kwart van de artikelen wordt geen frame gebruikt. In de dagbladen ligt dit percentage een stuk lager (7%). Ook de neutraal geframede berichten zijn vaker te vinden in de online berichtgeving (10%) dan in de dagbladen (8%). Dit geldt ook voor de constructief geframede berichten. Deze zijn respectievelijk in 8% en 2% van de artikelen te vinden online en in de dagbladen.



# 13. Frames over tijd
In onderstaande figuur geven we weer in hoeverre er constructieve en ondergravende frames voorkwamen in het nieuws en in hoeverre het nieuws neutraal was of zowel constructieve als ondergravende frames bevatte. Daarnaast onderscheiden we nog een vierde categorie berichten, namelijk die berichten waarin geen frame te vinden was. Dit zijn berichten waarin vooral feiten worden weergegeven die verder niet in een bepaalde context worden geplaatst. 

```{r, echo=F, warning=F, message=FALSE}
framing = read_csv("data/framing.csv")%>%rename(verhaalid=verhalen)
nieuws=readRDS("data/nieuws.rds")
alleverhalen = readRDS("data/alleverhalen.rds")
piekdagen=readRDS("data/piek_per_verhaal.rds")

framing |>
  left_join(nieuws)|>
  filter(id %in% alleverhalen$id)|>
  mutate(frametoon=case_when(soortframe=="Ondergravend" ~ -1,
                             soortframe=="Constructief" ~ 1,
                              T~0)) |>
  group_by(verhaalid,date, id) |>
  summarize(nframes=sum(aantal), frametoon=sum(frametoon * aantal))|>
  mutate(ifframe=case_when(nframes==0 ~ "Ongeframed",
                         frametoon==0 ~ "Neutraal/gemengd",
                         frametoon <0 ~ "Ondergravend",
                         frametoon>0  ~ "Constructief")) |>
  group_by(verhaalid, date, ifframe) |>
  summarize(nf=n(), .groups="drop") |> 
  filter(verhaalid=="coa_5") |>
  left_join(piekdagen) |>
  select(dag_from_peak, nf, ifframe) |>
  mutate(dag_from_peak = as.integer(dag_from_peak)) |>
  add_zeroes(index_cols=c("dag_from_peak", "ifframe"))|>
  mutate(week=round(dag_from_peak/7)) |> 
  filter(abs(week) <= 5) |>
  group_by(week, ifframe) |>
  summarize(nf=sum(nf))|>
  ggplot(aes(x=week, y=nf,  color=ifframe)) + geom_line()+
  ylab("Aantal artikelen")+
  xlab("")+
  theme_line() +scale_color_manual(values = svdj_colors)  +
  scale_x_continuous(breaks=c(-5,-4,-3,-2,-1,0,1,2,3,4,5))

```

We zien dat in het begin van het nieuwsverhaal, de eerste dagen, nog nieuws te vinden was waarin geen frames werden gebruikt. In het begin van het nieuwsverhaal worden naast artikelen met ondergravende frames ook artikelen teruggevonden waarin slechts feiten worden vermeld. De weken erna domineert het nieuws waarin vooral ondergravende frames worden gebruikt. Hier en daar zijn nog feitelijke artikelen te vinden, maar berichten met constructieve frames zijn niet of nauwelijks terug te vinden in het nieuws. 
\newpage
